1. приложение ServiceDesk, которое работает с пользовательскими
обращениями, фиксирует их в базе данных, с возможностью принятия этих
обращений сотрудниками поддержки.

2. Реализовано флоу пользователя и оператора. 
Пользователь: 
<Пользователь пишет сообщение в email;
Пользователю приходит автоответ, что сообщение в работе;
Пользователь получает сообщения от оператора;
После закрытия обращения, пользователю приходит сообщение, что
проблема решена>

Оператор:
<Получение списка обращений, есть возможность фильтрация по статусу и
сортировка по времени создания;
Оператор может назначить обращение на себя, ответить пользователю
через интерфейс API в email (см. п1 в пользовательском флоу)
По завершению работы, оператор закрывает обращение, новые сообщения
от пользователя поступают в новое обращение.
Приложение умеет читать сообщения с почты, на которую написал
пользователь и обрабатывать их.
Оператор общается через API, клиент получает сообщение на почту, с
которой писал.



Организовано асинхронное взаимодействие - отправка/вычитка сообщений
использует очереди, не позволяя им затеряться. Стек: Celery>



3. Реализовано API (Swagger), Стэк: FastAPI, PostgreSQL, Celery, Redis, SQLAlchemy, Alembic.

4. Установите все зависимости командой pip install -r requirements.txt

5. Для запуска Alembic используйте команду alembic init alembic, потом используйте команду alembic revision --autogenerate -m "Initial migration", а после примините миграции командой alembic upgrade head. Не забудьте настроить базу данных для PostgreSQL, вот пример: postgresql://postgres:postgres@localhost:5432/mydatabase

6. Для запуска приложения, запустите в терминале команду uvicorn app.main:app --reload

7. Скачайте и запустите Redis через Docker на порту 6379

8. для запуска Celery используйте команду celery -A app.tasks.celery_app worker --loglevel=info --pool=solo

9. В файле email_utils.py выберите свой SMTP сервер, я использовал в данном случае для yandex.ru, в SMTP_USER напишите свою почту, в SMTP_PASSWORD напишите свой пароль, сгенерированный через пароли приложений.


10. Как лучше всего проверить работу приложения: После запуска приложения и Celery через команды описанные выше, зайдите на http://127.0.0.1:8000/docs
Сначала создайте пользователей через POST/users/ Create New User, одного оператора, другой пользователь пусть будет обычный пользователь. Помните email должны быть уникальны! также определите в "role": "user" либо "role": "operator", кто он будет обычный пользователь или оператор.
После этого опробуйте метод POST/tickets/Create New Ticket. В нём напишите тему сообщение, само сообщение, и укажите user_id которой принадлежит обычному пользователю, пользователю с этим тикетом придет автоответ на его почту.
<Этот шаг с Create New Ticket реализует условия "Пользователь пишет сообщение в email;
Пользователю приходит автоответ, что сообщение в работе;">!
Оператор может назначить себя для решений этой проблемы через PATCH/tickets/{ticket_id}/assignAssign Ticket To Operator
Оператор может писать полюзователю через POST/tickets/{ticket_id}/reply Reply To Ticket
Пользователь может написать оператору через POST/messages/Send Message
Оператор может закрыть проблему в случае её решения через PATCH/tickets/{ticket_id}/close Close Ticket и пользователю придет автосообщение на почту.
Также оператор в случае необходимости может изменить статус тикета через PATCH/tickets/{ticket_id}Update Ticket Status
В случае если пользователь опять напишет сообщение через POST/messages/Send Message к уже закрытому тикету, то будет создано новое обращение от этого пользователя.
Через GET/ticketsGet Tickets можно получить список обращений с фильтрацией по статусу и сортировкой.
Реализовано "Организовать асинхронное взаимодействие - отправка/вычитка сообщений
использует очереди, не позволяя им затеряться. Стек: Celery"
Для получения писем с почты, нужно сначала использовать POST/emails/async/ Start Read Emails Task, получить свой свой "task_id"
Потом в GET/emails/async/{task_id} Get Email Task Result вставьте свой task_id и вы получите сообщения со своей почты.
Чтобы отправить сообщение на почту через Celery воспользуйтесь POST/emails/send_async/ Send Email Async. Напишите заголовок письма, почту на которую придет письмо, и само сообщение.


11. P.S. Тесты реализованы не были
